var X=Object.defineProperty;var _=(h,e)=>()=>(h&&(e=h(h=0)),e);var B=(h,e)=>{for(var s in e)X(h,s,{get:e[s],enumerable:!0})};var R={};B(R,{default:()=>pe});import L from"fs";import{JSDOM as ge}from"jsdom";var he,pe,q=_(()=>{he=()=>{let e=JSON.parse(L.readFileSync("../../src/data/component.json","utf8")).socialMedia.filter(s=>Object.values(s)[0].length!==0).map(s=>{switch(Object.keys(s)[0]){case"facebook":return`	<div><a href="${Object.values(s)[0]}" class="color-facebook text-decoration-none"><i class="fab fa-facebook-square"></i> Facebook</a></div>`;case"twitter":return`	<div><a href="${Object.values(s)[0]}" class="color-twitter text-decoration-none"><i class="fab fa-twitter"></i> Twitter</a></div>`;case"instagram":return`	<div><a href="${Object.values(s)[0]}" class="color-instagram text-decoration-none"><i class="fab fa-instagram"></i> Instagram</a></div>`;case"linkedin":return`	<div><a href="${Object.values(s)[0]}" class="color-linkedin text-decoration-none"><i class="fab fa-linkedin"></i> Linkedin</a></div>`;case"behance":return`	<div><a href="${Object.values(s)[0]}" class="color-behance text-decoration-none"><i class="fab fa-behance"></i> Behance</a></div>`;case"whatsapp":return`	<div><a href="${Object.values(s)[0]}" class="color-whatsapp text-decoration-none"><i class="fab fa-whatsapp"></i> Whatsapp</a></div>`;case"telegram":return`	<div><a href="${Object.values(s)[0]}" class="color-telegram text-decoration-none"><i class="fab fa-telegram-plane"></i> Telegram</a></div>`;case"youtube":return`	<div><a href="${Object.values(s)[0]}" class="color-youtube text-decoration-none"><i class="fab fa-youtube"></i> Youtube</a></div>`}}).join(`
`);L.readFile("../../src/partials/components/component-social-media.hbs","utf8",(s,o)=>{let i=o.split(`
`)[0],a=new ge(o),n=a.window.document.querySelector(".social-media-list")!==null?a.window.document.querySelector(".social-media-list"):!1;n&&(n.innerHTML=`
${e}
`);let c=i.concat(`
`,a.window.document.documentElement.childNodes[1].innerHTML);L.writeFileSync("../../src/partials/components/component-social-media.hbs",c)})},pe=he});var W={};B(W,{default:()=>me});import A from"fs";import{JSDOM as ue}from"jsdom";var fe,me,z=_(()=>{fe=()=>{let h=JSON.parse(A.readFileSync("../../src/data/component.json","utf8")).footer;A.readFile("../../src/partials/components/component-footer.hbs","utf8",(e,s)=>{let o=s.split(`
`)[0],i=new ue(s),a=i.window.document.querySelector(".copyright-text"),n=i.window.document.querySelector(".footer-logo");h.siteLogo.enabled?(n.children[0].classList.add("d-lg-inline-block"),n.children[0].classList.remove("d-none"),n.children[0].setAttribute("src",`{{root}}${h.siteLogo.logo.src}`),n.children[0].setAttribute("width",h.siteLogo.logo.width),n.children[0].setAttribute("height",h.siteLogo.logo.height)):(n.children[0].classList.add("d-none"),n.children[0].classList.remove("d-lg-inline-block")),a.innerHTML=h.copyrightText;let c=i.window.document.documentElement.childNodes[1].innerHTML.replace(/&gt;/g,">"),l=o.concat(`
`,c);A.writeFileSync("../../src/partials/components/component-footer.hbs",l)})},me=fe});import ye from"gulp";import G from"gulp-task-err-handler";import Z from"fs";import ee from"del";import H from"panini";import J from"gulp-rename";import E from"gulp-jsbeautifier";import F from"gulp-minifier";import I from"merge-stream";import se from"gulp-concat";import te from"gulp-babel";import oe from"gulp-sass";import ie from"sass";import ae from"gulp-purgecss";import re,{gifsicle as ne,mozjpeg as le,optipng as ce,svgo as de}from"gulp-imagemin";import $ from"fs";var j=class{constructor(e){Object.assign(this,e)}appInfo=e=>{let s=JSON.parse($.readFileSync("package.json","utf-8"));console.log(`
${s.title} v${s.version} running on Node.js ${process.version}
`),process.argv.pop()=="blockit"&&(console.log("  builder url:    http://localhost:3001"),console.log(`  preview url:    http://localhost:3000
`),console.log(`${this.logTime(new Date)} - Waiting for changes...`)),e()};logTime=e=>`[${new Intl.DateTimeFormat("en",{hour:"2-digit",minute:"2-digit",second:"2-digit",hourCycle:"h24"}).format(e)}]`;errHandler=(e,s)=>{switch(e.name){case s.buildHtml.name:let o=String(e.error).split(" ").slice(5,-5).join(" "),i=String(e.error).split(" ").slice(5)[2];console.log(`${this.logTime(new Date)} - ${o=="The partial"?`HTML compile a problem occurred: The partial ${i} could not be found`:`HTML compile a problem occurred: ${e.error}`}`);break;case s.buildCss.name:let a=String(e.error.formatted).split(" ").slice(1,-4).join(" ");console.log(`${this.logTime(new Date)} - CSS compile a problem occurred: ${a}`);break;case s.buildJs.name:console.log(`${this.logTime(new Date)} - JS compile a problem occurred: ${e.error}`);break;case s.buildStatic.name:console.log(`${this.logTime(new Date)} - Static assets deliver a problem occurred: ${e.error}`);break;case s.buildImg.name:console.log(`${this.logTime(new Date)} - Image optimization a problem occurred: ${e.error}`);break;case s.name:console.log(`${this.logTime(new Date)} - a problem occurred: ${e.error}`);break}};hookSearch=e=>{$.existsSync("../../src/hooks/blog/search-post.hbs")&&$.existsSync("../../src/hooks/blog/search-result.hbs")?(hookSearchWrite("../../src/hooks/blog/search-post.hbs","../../src/hooks/blog/search-result.hbs"),e()):(hookSearchWrite("hooks/blog/search-post.hbs","hooks/blog/search-result.hbs"),e())};hookSearchWrite=(e,s)=>{let o=$.readFileSync(e,"utf8"),i=$.readFileSync(s,"utf8");$.readFile("../../src/assets/js/utilities/blog.js","utf8",(a,n)=>{let c=/(?<=notFoundDiv.innerHTML\s=\s\`)([^`]*)(?=\`)/,l=/(?<=return\s\`)([^`]*)(?=\`)/g,g=n.replace(c,i).replace(l,o);$.writeFileSync("../../src/assets/js/utilities/blog.js",g)})};hookSectionsPreview=()=>this.src("../../src/hooks/sections/previews/*").pipe(this.dest("./views/assets/img/sections"))};var D=class{constructor(e){Object.assign(this,e),this.utils=new j}reloadPanini=async()=>{await H.refresh()};buildClean=()=>ee(["../../dist/**","../../dist/img/*","!../../dist/blog","!../../dist/blog/data","!../../dist/img","!../../dist/img/user"],{force:!0});buildHtml=()=>{let e=JSON.parse(Z.readFileSync("../../src/data/setting.json","utf-8")).optimization.minifyAssets.html;return this.reloadPanini(),this.src("../../src/pages/**/*.hbs").pipe(H({root:"../../src/pages",layouts:"../../src/layouts",partials:"../../src/partials",data:"../../src/data",helpers:"./helpers"})).pipe(J(s=>s.extname=".html")).pipe(E({html:{file_types:[".html"],max_preserve_newlines:0,preserve_newlines:!0}})).pipe(e?F({minify:!0,minifyHTML:{collapseWhitespace:!0,removeComments:!0}}):F({minify:!1})).pipe(this.dest("../../dist")).on("end",()=>console.log(`${this.utils.logTime(new Date)} - HTML compiled successfully.`))};buildCss=()=>{let e=oe(ie);return this.src("../../src/assets/scss/main.scss").pipe(e()).pipe(J("style.css")).pipe(E({css:{file_types:[".css"]}})).pipe(this.dest("../../dist/css")).on("end",()=>console.log(`${this.utils.logTime(new Date)} - CSS compiled successfully.`))};buildJs=()=>I(this.src("../../src/assets/js/*.js").pipe(E({js:{file_types:[".js"]}})).pipe(this.dest("../../dist/js")),this.src("../../src/assets/js/utilities/*.js").pipe(te({presets:[["@babel/preset-env",{targets:"> 0.25%, not dead",exclude:["babel-plugin-transform-async-to-generator","babel-plugin-transform-regenerator"]}]]})).pipe(se("utilities.min.js",{newLine:`\r
\r
`})).pipe(F({minify:!0,minifyJS:{sourceMap:!1}})).pipe(this.dest("../../dist/js")),this.src("../../src/assets/js/vendors/*.js").pipe(F({minify:!0,minifyJS:{sourceMap:!1}})).pipe(this.dest("../../dist/js/vendors")).on("end",()=>console.log(`${this.utils.logTime(new Date)} - JS compiled successfully.`)));buildImg=()=>this.src("../../src/assets/img/**/*").pipe(re([ne({interlaced:!0}),le({quality:80,progressive:!0}),ce({optimizationLevel:5}),de({plugins:[{name:"removeViewBox",active:!0},{name:"cleanupIDs",active:!1}]})],{verbose:!1,silent:!0})).pipe(this.dest("../../dist/img")).on("end",()=>console.log(`${this.utils.logTime(new Date)} - Images optimized successfully.`));buildStatic=()=>I(this.src("../../src/assets/fonts/*").pipe(this.dest("../../dist/fonts")),this.src(["../../node_modules/@fortawesome/fontawesome-free/webfonts/fa-brands-400.ttf","../../node_modules/@fortawesome/fontawesome-free/webfonts/fa-brands-400.woff2","../../node_modules/@fortawesome/fontawesome-free/webfonts/fa-solid-900.ttf","../../node_modules/@fortawesome/fontawesome-free/webfonts/fa-solid-900.woff2"]).pipe(this.dest("../../dist/fonts")),this.src("../../src/assets/favicon/favicon.ico").pipe(this.dest("../../dist/img")),this.src("../../src/assets/favicon/apple-touch-icon.png").pipe(this.dest("../../dist/img")),this.src("../../src/assets/php/sendmail.php").pipe(this.dest("../../dist")),this.src("../../node_modules/bootstrap/dist/js/bootstrap.bundle.min.js").pipe(F({minify:!0,minifyJS:{sourceMap:!1}})).pipe(J("bootstrap.min.js")).pipe(this.dest("../../dist/js/vendors")),this.src("../../node_modules/isotope-layout/dist/isotope.pkgd.min.js").pipe(J("isotope.min.js")).pipe(this.dest("../../dist/js/vendors")),this.src("../../node_modules/bigger-picture/dist/bigger-picture.min.js").pipe(this.dest("../../dist/js/vendors")).on("end",()=>console.log(`${this.utils.logTime(new Date)} - Static assets delivered successfully.`)));minifyCss=()=>this.src("../../dist/css/*.css").pipe(ae({content:["../../dist/*.html","../../dist/js/**/*.js"]})).pipe(F({minify:!0,minifyCSS:!0})).pipe(this.dest("../../dist/css"));minifyJs=()=>this.src("../../src/assets/js/*.js").pipe(F({minify:!0,minifyJS:{sourceMap:!1}})).pipe(this.dest("../../dist/js"));blockitWatch=()=>{this.watch("../../src/assets/scss/**/*.scss",this.series(this.buildCss)),this.watch("../../src/assets/js/**/*.js",this.series(this.buildJs)),this.watch("../../src/assets/img/**/*",this.series(this.buildImg)),this.watch(["../../src/**/*.hbs","../../src/data/**/*.json"],this.series(this.buildHtml)),this.watch(["../../src/hooks/blog/search-post.hbs","../../src/hooks/blog/search-result.hbs"],this.series(this.utils.hookSearch)),this.watch("../../src/hooks/sections/previews/*",this.series(this.utils.hookSectionsPreview))}};import t from"fs";import{execSync as T}from"child_process";import{JSDOM as be}from"jsdom";var P=class{constructor(e){this.socket=e}createDashboardData=()=>{let e={name:JSON.parse(t.readFileSync("./package.json","utf-8")).title,version:JSON.parse(t.readFileSync("./package.json","utf-8")).version,theme:process.env.npm_package_title,pages:t.readdirSync("../../src/pages","utf8").filter(s=>s.match(/.(hbs)$/i)).filter(s=>!s.match(/blog-page/g)&&!s.match(/blog-find/g)).length,posts:t.readdirSync("../../src/data/blog/posts","utf8").length,authors:JSON.parse(t.readFileSync("../../src/data/setting.json","utf8")).authors.length};this.socket.emit("dashboardData",e)};createPagesData=()=>{t.readdir("../../src/pages",(e,s)=>{let o=s.filter(i=>i.match(/.(hbs)$/i)).filter(i=>!i.match(/blog-page/g)&&!i.match(/blog-find/g)).map(i=>({page:i.split(".").slice(0,-1).join("."),title:t.readFileSync(`../../src/pages/${i}`,"utf8").match(/(?<=title:\s).*/g)[0],date:t.statSync(`../../src/pages/${i}`).mtime,layout:t.readFileSync(`../../src/pages/${i}`,"utf8").match(/(?<=layout:\s).*/g)[0],breadcrumb:t.readFileSync(`../../src/pages/${i}`,"utf8").match(/(?<=breadcrumb:\s).*/g)[0],sections:t.readFileSync(`../../src/pages/${i}`,"utf8").match(/{{>(.*?)}}*/g).map(a=>a.substring(4).slice(0,-3))}));this.socket.emit("pagesData",o)}),t.readFile("../../src/data/setting.json","utf8",(e,s)=>{let o=JSON.parse(s).blog.asBlog!==!1?JSON.parse(s).blog.asBlog.split(".")[0]:!1;this.socket.emit("pagesCurrentBlog",o)})};createPagesActionData=()=>{t.readdir("templates",(e,s)=>{let o=s.filter(r=>r.match(/.(hbs)$/i)),i=t.readdirSync("../../src/hooks/sections","utf-8").filter(r=>!r.includes("blog")).filter(r=>r.match(/.(hbs)$/i)),a=this.utilCheckHook()&&i.length!==0?i:!1,c={name:`Exclusive - ${a!==!1?a[0].split("-")[1].charAt(0).toUpperCase()+a[0].split("-")[1].slice(1):"empty"}`,sections:a,icon:"fa-award"},l=[{name:"Card",sections:o.filter(r=>r.includes("card")),icon:"fa-sticky-note"},{name:"Client logo",sections:o.filter(r=>r.includes("client-logo")),icon:"fa-shapes"},{name:"Contact",sections:o.filter(r=>r.includes("contact")),icon:"fa-map-marker-alt"},{name:"Content",sections:o.filter(r=>r.includes("content")),icon:"fa-file-alt"},{name:"Counter",sections:o.filter(r=>r.includes("counter")),icon:"fa-hourglass-half"},{name:"Faq",sections:o.filter(r=>r.includes("faq")),icon:"fa-question"},{name:"Feature",sections:o.filter(r=>r.includes("feature")),icon:"fa-cubes"},{name:"Gallery",sections:o.filter(r=>r.includes("gallery")),icon:"fa-images"},{name:"Pricing",sections:o.filter(r=>r.includes("pricing")),icon:"fa-money-bill-wave"},{name:"Slideshow",sections:o.filter(r=>r.includes("slideshow")),icon:"fa-layer-group"},{name:"Team",sections:o.filter(r=>r.includes("team")),icon:"fa-users"},{name:"Testimonial",sections:o.filter(r=>r.includes("testimonial")),icon:"fa-comment-dots"},{name:"Timeline",sections:o.filter(r=>r.includes("timeline")),icon:"fa-history"},{name:"Utility",sections:o.filter(r=>r.includes("utility")),icon:"fa-screwdriver-wrench"}];a!==!1&&l.splice(5,0,c),this.socket.emit("pagesActionData",l)})};pagesDeletePage=(e,s)=>{t.readFile(`../../src/pages/${e}.hbs`,"utf8",(o,i)=>{i.match(/(?<=as_blog:\s).*/g)[0]=="false"?(t.unlinkSync(`../../dist/${e}.html`),t.unlinkSync(`../../src/pages/${e}.hbs`),s!==void 0&&s.forEach(n=>!n.includes("section-slideshow")&&t.unlinkSync(`../../src/partials/sections/${n}.hbs`))):(t.unlinkSync(`../../dist/${e}.html`),t.unlinkSync(`../../src/pages/${e}.hbs`),t.unlinkSync("../../dist/blog-find.html"),t.unlinkSync("../../src/pages/blog-find.hbs"),t.readdir("../../src/pages",(n,c)=>{c.filter(l=>l.match(/.(hbs)$/i)).filter(l=>l.match(/blog-page/g)).forEach(l=>{t.unlinkSync(`../../dist/${l.split(".").slice(0,-1)[0]}.html`),t.unlinkSync(`../../src/pages/${l}`)})}),t.readFile("../../src/data/setting.json","utf8",(n,c)=>{let l=JSON.parse(c);l.blog.asBlog=!1,t.writeFileSync("../../src/data/setting.json",JSON.stringify(l,null,2)),this.socket.emit("pagesCurrentBlog",l.blog.asBlog)}),t.readFile("../../src/assets/js/utilities/breadcrumb.js","utf8",(n,c)=>{let l=c.replace(/(?<=this\.blogPath\s\=\s).*/g,!1);t.writeFileSync("../../src/assets/js/utilities/breadcrumb.js",l)}),t.readFile("../../src/assets/js/utilities/active-menu.js","utf8",(n,c)=>{let l=c.replace(/(?<=this\.blogPath\s\=\s).*/g,!1);t.writeFileSync("../../src/assets/js/utilities/active-menu.js",l)}))})};pagesSavePage=(e,s,o)=>{s?t.readFile("../../src/data/setting.json","utf8",(i,a)=>{let n=JSON.parse(a);n.blog.asBlog=`${e}.hbs`,t.writeFileSync("../../src/data/setting.json",JSON.stringify(n,null,2)),t.readFile("../../src/assets/js/utilities/breadcrumb.js","utf8",(r,g)=>{let f=g.replace(/(?<=this\.blogPath\s\=\s).*/g,`'${e}.html'`);t.writeFileSync("../../src/assets/js/utilities/breadcrumb.js",f)}),t.readFile("../../src/assets/js/utilities/active-menu.js","utf8",(r,g)=>{let f=g.replace(/(?<=this\.blogPath\s\=\s).*/g,`'${e}.html'`);t.writeFileSync("../../src/assets/js/utilities/active-menu.js",f)});function c(r){let S=t.readFileSync(r,"utf8").replace(/(?<=layout:\s).*/g,o.layout).replace(/(?<=title:\s).*/g,o.title).replace(/(?<=breadcrumb:\s).*/g,o.breadcrumb);t.writeFileSync(r,S)}t.existsSync("../../src/hooks/pages/blog.hbs")?c("../../src/hooks/pages/blog.hbs"):c("hooks/pages/blog.hbs"),t.existsSync("../../src/hooks/pages/blog-single.hbs")?c("../../src/hooks/pages/blog-single.hbs"):c("hooks/pages/blog-single.hbs"),t.existsSync("../../src/hooks/pages/blog-find.hbs")?c("../../src/hooks/pages/blog-find.hbs"):c("hooks/pages/blog-find.hbs"),t.readdir("../../src/pages/blog",(r,g)=>{g.forEach(f=>c(`../../src/pages/blog/${f}`))}),t.readFile("../../src/data/blog/blog.json","utf8",(r,g)=>{let f=JSON.parse(g),b={defaultPage:t.existsSync("../../src/hooks/pages/blog.hbs")?t.readFileSync("../../src/hooks/pages/blog.hbs","utf8"):t.readFileSync("hooks/pages/blog.hbs","utf8"),singlePage:t.existsSync("../../src/hooks/pages/blog-single.hbs")?t.readFileSync("../../src/hooks/pages/blog-single.hbs","utf8"):t.readFileSync("hooks/pages/blog-single.hbs","utf8"),defaultSection:t.existsSync("../../src/hooks/sections/section-blog.hbs")?t.readFileSync("../../src/hooks/sections/section-blog.hbs","utf8"):t.readFileSync("hooks/sections/section-blog.hbs","utf8"),singleSection:t.existsSync("../../src/hooks/sections/section-blog-single.hbs")?t.readFileSync("../../src/hooks/sections/section-blog-single.hbs","utf8"):t.readFileSync("hooks/sections/section-blog-single.hbs","utf8")};this.postPaginatorPage(f,b)});let l=t.existsSync("../../src/hooks/pages/blog-find.hbs")?"../../src/hooks/pages/blog-find.hbs":"hooks/pages/blog-find.hbs";t.readFile(l,"utf8",(r,g)=>{let S=g.replace(/(?<=layout:\s).*/g,o.layout).replace(/(?<=title:\s).*/g,o.title).replace(/(?<=breadcrumb:\s).*/g,o.breadcrumb);t.writeFileSync("../../src/pages/blog-find.hbs",S)})}):t.writeFileSync(`../../src/pages/${e}.hbs`,o)};readSectionData=e=>{let s=e.split("-").length>=4?`../../src/partials/sections/${e}.hbs`:`templates/${e}.hbs`;t.readFile(s,"utf8",(o,i)=>{let a={blocks:[{id:e,type:"code",data:{language:"HTML",text:i}}]};this.socket.emit("resultSectionData",a)})};createSectionData=(e,s)=>{e.forEach(o=>{t.readFile(`templates/${o.reference}.hbs`,"utf8",(i,a)=>{a.includes("<!-- slideshow content begin -->")?t.writeFileSync(`../../src/partials/sections/${o.reference}.hbs`,o.updateData!==!1?o.updateData:a):t.writeFileSync(`../../src/partials/sections/${o.reference}-${o.id}.hbs`,o.updateData!==!1?o.updateData:a)})}),(s.length!==0||s[0]!==!1)&&s.forEach(o=>{try{t.existsSync(`../../src/partials/sections/${o}.hbs`)&&t.unlinkSync(`../../src/partials/sections/${o}.hbs`)}catch(i){console.error(`file not found: ${i}`)}})};createPostsData=()=>{t.readdir("../../src/data/blog/posts",(e,s)=>{let o=s.map(i=>{let a=JSON.parse(t.readFileSync(`../../src/data/blog/posts/${i}`,"utf8"));return{title:a.title,link:a.link,dateCreated:a.dateCreated,dateModified:a.dateModified,timeCreated:a.timeCreated,timeModified:a.timeModified,author:a.author,category:a.category}});this.socket.emit("postsData",o)})};createPostsActionData=e=>{let s=JSON.parse(t.readFileSync("../../src/data/setting.json","utf8")),o=e!=="empty"?JSON.parse(t.readFileSync(`../../src/data/blog/posts/${e}.json`,"utf8")):null,i={authors:{current:o!==null?o.author.name:"",select:s.authors},categories:{current:o!==null?o.category:"",select:s.blog.categories},currentTags:o!==null?o.tags:"",currentImage:o!==null?o.image:!1,title:o!==null?o.title:"",dateCreated:o!==null?o.dateCreated:"",timeCreated:o!==null?o.timeCreated:"",blocks:o!==null?o.blocks:""};this.socket.emit("postsActionData",i)};postPaginatorWidget=(e,s,o,i)=>{let a=s||1,n=o||10,c=(a-1)*n,l=e.slice(c).slice(0,o),r=Math.ceil(e.length/n);return{page:a,per_page:n,prev_page:a-1?a-1:null,next_page:r>a?a+1:null,total_post:e.length,total_pages:r,display_author:i.blog.displayAuthor,data:l}};postPaginatorPage=(e,s)=>{let o=JSON.parse(t.readFileSync("../../src/data/setting.json","utf8"));setTimeout(()=>{let i=o.blog.postPerPage,n=this.postPaginatorWidget(e.post,1,i,o).total_pages;if(o.blog.asBlog!==!1){let d=1;for(;d<=n;){let u=`blog-page-${d}`,C=this.postPaginatorWidget(e.post,d,i,o);t.writeFileSync(`../../src/data/blog/${u}.json`,JSON.stringify(C,null,2));let m=s.defaultPage.replace(/(?<={{> section-blog-)(.*?)(?= }})/g,d);d==1?t.writeFileSync(`../../src/pages/${o.blog.asBlog}`,m):t.writeFileSync(`../../src/pages/blog-page-${d}.hbs`,m);let k=s.defaultSection.replace(/{{#each(.*?).data}}/g,`{{#each blog-page-${d}.data}}`).replace(/{{#if(.*?).display_author}}/g,`{{#if @root.blog-page-${d}.display_author}}`);t.writeFileSync(`../../src/partials/blog/section-blog-${d}.hbs`,k),d++}}t.readdir("../../src/data/blog",(d,u)=>{let C=u.filter(k=>k.match(/(blog-page-)/g)),m=n+1,p=C.length;for(;m<=p;)t.existsSync(`../../src/data/blog/blog-page-${m}.json`)&&t.unlinkSync(`../../src/data/blog/blog-page-${m}.json`),t.existsSync(`../../src/pages/blog-page-${m}.hbs`)&&t.unlinkSync(`../../src/pages/blog-page-${m}.hbs`),t.existsSync(`../../dist/blog-page-${m}.html`)&&t.unlinkSync(`../../dist/blog-page-${m}.html`),m++}),t.readdir("../../src/partials/blog",(d,u)=>{let C=u.filter(p=>p.match(/section-blog/g)).sort((p,k)=>p.length-k.length).filter((p,k)=>k<n);u.filter(p=>p.match(/section-blog/g)).filter(p=>!C.includes(p)).forEach(p=>{t.existsSync(`../../src/partials/blog/${p}`)&&t.unlinkSync(`../../src/partials/blog/${p}`)})});let c=[];for(let d=0;d<3;d++)c.push({title:e.post[d].title,link:e.post[d].link,date:e.post[d].dateCreated});let r=e.post.map(d=>d.tags).filter(d=>d).reduce((d,u)=>d.concat(u),[]).map(d=>d),g=r.filter((d,u)=>r.indexOf(d)==u),f=e.post.map(d=>d.category),b=f.filter((d,u)=>f.indexOf(d)==u),w={asBlog:o.blog.asBlog!==!1?`${o.blog.asBlog.split(".").slice(0,-1)}.html`:!1,totalPages:n,tagLists:g,latestPost:c};t.writeFileSync("../../dist/blog/data/data-blog.json",JSON.stringify(w)),t.readFile("../../src/data/blog/blog.json","utf8",(d,u)=>{let C=JSON.parse(u),m=b.map(p=>this.createCategoryPost(C.post,p));t.writeFileSync("../../dist/blog/data/data-category.json",JSON.stringify(m))}),t.readFile("../../src/data/blog/blog.json","utf8",(d,u)=>{let C=JSON.parse(u),m=g.map(p=>this.createTagPost(C.post,p));m.forEach(p=>{p.posts.forEach(k=>{delete k.tags,delete k.blocks})}),t.writeFileSync("../../dist/blog/data/data-tag.json",JSON.stringify(m))})},600)};createCategoryPost=(e,s)=>{let o=e.filter(i=>i.category===s);return o.forEach(i=>{i.content=this.utilTrimString(i.blocks[0].data.text),i.date=i.dateCreated,delete i.author.id,delete i.blocks,delete i.share,delete i.category,delete i.tags,delete i.dateCreated,delete i.timeCreated,i.image||delete i.image}),{category:s,totalPost:o.length,posts:o}};createTagPost=(e,s)=>{let o=[];return e.forEach(i=>{i.tags.filter(a=>{a===s&&o.push(i)})}),o.forEach(i=>{i.content=this.utilTrimString(i.blocks[0].data.text),i.date=i.dateCreated!==void 0?i.dateCreated:i.date,delete i.author.id,delete i.share,delete i.dateCreated,delete i.timeCreated,i.image||delete i.image}),{tag:s,totalPost:o.length,posts:o}};postCreatePage=e=>{t.readdir("../../src/data/blog/posts",(s,o)=>{let i={post:o.map(a=>JSON.parse(t.readFileSync(`../../src/data/blog/posts/${a}`,"utf8")))};i.post.sort((a,n)=>new Date(`${n.dateCreated} ${n.timeCreated}`)-new Date(`${a.dateCreated} ${a.timeCreated}`)),t.readFile("../../src/data/blog/blog.json","utf-8",(a,n)=>{let c=JSON.parse(n).post.map(r=>(delete r.dateModified,delete r.timeModified,r)),l=i.post.map(r=>(delete r.dateModified,delete r.timeModified,r));JSON.stringify(c)!==JSON.stringify(l)&&t.writeFileSync("../../src/data/blog/blog.json",JSON.stringify(i,null,2))}),this.postPaginatorPage(i,e)})};postsSaveContent=async(e,s,o)=>{t.unlink("../../dist/blog/*.html",i=>{t.writeFileSync(`../../src/data/blog/posts/${e}.json`,JSON.stringify(s,null,2));let a=o.singleSection.replace(/(post-title)/g,e);t.writeFileSync(`../../src/partials/blog/post-title-${e}.hbs`,a);let n=o.singlePage.replace(/(?<={{> post-title)(.*?)(?= }})/g,`-${e}`);t.writeFileSync(`../../src/pages/blog/${e}.hbs`,n),this.postCreatePage(o)})};postsDeletePost=(e,s)=>{let o=[`../../src/data/blog/posts/${e}.json`,`../../src/pages/blog/${e}.hbs`,`../../src/partials/blog/post-title-${e}.hbs`,`../../dist/blog/${e}.html`];return Promise.all(o.map(i=>{t.unlinkSync(i)})).then(this.socket.emit("deleteDone","success"),this.postCreatePage(s))};createEditorData=e=>{t.readFile(`../../src/data/blog/posts/${e}.json`,"utf8",(s,o)=>this.socket.emit("editorData",o))};postsTagSources=()=>{let e={defaultPage:t.existsSync("../../src/hooks/pages/blog.hbs")?t.readFileSync("../../src/hooks/pages/blog.hbs","utf8"):t.readFileSync("hooks/pages/blog.hbs","utf8"),singlePage:t.existsSync("../../src/hooks/pages/blog-single.hbs")?t.readFileSync("../../src/hooks/pages/blog-single.hbs","utf8"):t.readFileSync("hooks/pages/blog-single.hbs","utf8"),defaultSection:t.existsSync("../../src/hooks/sections/section-blog.hbs")?t.readFileSync("../../src/hooks/sections/section-blog.hbs","utf8"):t.readFileSync("hooks/sections/section-blog.hbs","utf8"),singleSection:t.existsSync("../../src/hooks/sections/section-blog-single.hbs")?t.readFileSync("../../src/hooks/sections/section-blog-single.hbs","utf8"):t.readFileSync("hooks/sections/section-blog-single.hbs","utf8")};this.socket.emit("tagSourcesData",e)};findBlogTitle=(e,s,o)=>{if(e.hasOwnProperty(s)&&e[s]===o)return e;for(let i of Object.keys(e))if(typeof e[i]=="object"){let a=this.findBlogTitle(e[i],s,o);if(a!==null&&typeof a<"u")return a}return null};createBlogTitle=e=>{if(this.findBlogTitle(e,"link","blog/page-1.html")!==null){let s=this.findBlogTitle(e,"link","blog/page-1.html").title;t.readdir("../../src/pages/blog",(o,i)=>{i.forEach(a=>{t.readFile(`../../src/pages/blog/${a}`,"utf8",(n,c)=>{let r=c.replace(/(?<=data-title=")([^"]*)/g,s.toLowerCase()).replace(/(?<=title:\s).*/g,s);t.writeFileSync(`../../src/pages/blog/${a}`,r)})})})}};createNavigationData=()=>{let e={nav:JSON.parse(t.readFileSync("../../src/data/navigation.json","utf8")).nav,select:t.readdirSync("../../src/pages","utf8").filter(s=>!s.match(/blog-page/g)&&!s.match(/blog-find/g)).filter(s=>s.match(/.(hbs)$/i))};this.socket.emit("navigationData",e)};saveNavigationData=e=>{t.writeFileSync("../../src/data/navigation.json",JSON.stringify(e,null,2)),this.createBlogTitle(e)};assetsUpload=(e,s)=>{t.writeFile(`../../dist/img/user/${s}`,e,o=>{this.socket.emit("uploadDone",`img/user/${s}`)})};assetsDelete=e=>{t.unlink(`../../dist/img/user/${e}`,s=>{this.socket.emit("deleteDone","success")})};saveSettingsData=(e,s)=>{t.readFile("../../src/assets/scss/_colors.scss","utf8",(o,i)=>{let a=i,u=a.replace(/(?<=primary:\s)([^;]*)/g,e.colors.primaryColor).replace(/(?<=secondary:\s)([^;]*)/g,e.colors.secondaryColor).replace(/(?<=success:\s)([^;]*)/g,e.colors.successColor).replace(/(?<=info:\s)([^;]*)/g,e.colors.infoColor).replace(/(?<=warning:\s)([^;]*)/g,e.colors.warningColor).replace(/(?<=danger:\s)([^;]*)/g,e.colors.dangerColor).replace(/(?<=light:\s)([^;]*)/g,e.colors.lightColor).replace(/(?<=dark:\s)([^;]*)/g,e.colors.darkColor).replace(/(?<=body-bg:\s)([^;]*)/g,e.colors.backgroundColor).replace(/(?<=body-color:\s)([^;]*)/g,e.colors.textColor).replace(/(?<=link-color:\s)([^;]*)/g,e.colors.linkColor);a!==u&&t.writeFileSync("../../src/assets/scss/_colors.scss",u)}),t.readFile("../../src/data/setting.json","utf-8",(o,i)=>{i!==JSON.stringify(e,null,2)&&t.writeFileSync("../../src/data/setting.json",JSON.stringify(e,null,2)),this.postCreatePage(s),this.updateAuthorData(i,e,s),this.runMinifying(i,e)})};runMinifying=(e,s)=>{let o=s.optimization.minifyAssets.css,i=s.optimization.minifyAssets.js,a=JSON.parse(e).optimization.minifyAssets.css!==o,n=JSON.parse(e).optimization.minifyAssets.js!==i;a&&o?T("gulp -S --f index.js minifyCss"):a&&!o&&T("gulp -S --f index.js compileCss"),n&&i?T("gulp -S --f index.js minifyJs"):n&&!i&&T("gulp -S --f index.js compileJs")};saveEmail=e=>{t.readFile("../../dist/sendmail.php","utf8",(s,o)=>{if(String(o.match(/(?<=emailTo = ).*/g))!==`"${e}";`){let a=o.replace(/(?<=emailTo = ).*/g,`"${e}";`);t.writeFileSync("../../dist/sendmail.php",a)}})};saveMap=e=>{t.readdir("../../src/partials/sections",(s,o)=>{o.filter(a=>a.match(/section-contact/g)).forEach(a=>{t.readFile(`../../src/partials/sections/${a}`,"utf8",(n,c)=>{let l=c.split(`
`)[0],r=new be(c),g=r.window.document.querySelector("iframe");if(g!==null){g.src=e;let f=l.concat(`
`,r.window.document.documentElement.childNodes[1].innerHTML);t.writeFileSync(`../../src/partials/sections/${a}`,f)}})})})};saveSocialMedia=()=>{t.existsSync("../src/hooks/components/social-media.js")?import("../../src/hooks/components/social-media.js").then(e=>e.default()):Promise.resolve().then(()=>(q(),R)).then(e=>e.default())};saveFooter=()=>{t.existsSync("../src/hooks/components/footer.js")?import("../../src/hooks/components/footer.js").then(e=>e.default()):Promise.resolve().then(()=>(z(),W)).then(e=>e.default())};saveSlideshow=e=>{let s=t.readFileSync("hooks/slideshow/slideshow-wrapper.hbs","utf8");t.existsSync("../src/hooks/slideshow/slideshow-wrapper.hbs")&&(s=t.readFileSync("../src/hooks/slideshow/slideshow-wrapper.hbs","utf8"));let o=["section-slideshow-1.hbs","section-slideshow-2.hbs","section-slideshow-3.hbs","section-slideshow-4.hbs"],i=e.map((n,c)=>n.slides.length!==0?c:!1).filter(n=>n!==!1).map(n=>`section-slideshow-${n+1}.hbs`),a=o.filter(n=>!i.includes(n));e.forEach((n,c)=>{if(n.slides.length!==0){let l=n.slides.map(g=>g.text),r=s.replace(/\{{(.*slide-id)\}}/g,l.join(" "));t.writeFileSync(`templates/section-slideshow-${c+1}.hbs`,r),t.writeFileSync(`../../src/partials/sections/section-slideshow-${c+1}.hbs`,r)}}),t.readdir("templates",(n,c)=>{c.filter(l=>a.includes(l)).forEach(l=>{t.unlinkSync(`templates/${l}`),t.unlinkSync(`../../src/partials/sections/${l}`)})})};createSettingsData=()=>{t.readFile("../../src/data/setting.json","utf8",(e,s)=>this.socket.emit("settingsData",JSON.parse(s)))};createFooterData=()=>{t.readFile("../src/partials/components/component-footer.hbs","utf8",(e,s)=>{let o={blocks:[{id:"footer-content",type:"code",data:{language:"HTML",text:s}}]};this.socket.emit("footerData",o)})};saveFooterEditor=e=>{Object.keys(e).length!==0&&t.writeFileSync("../src/partials/components/component-footer.hbs",e)};createSlideItem=e=>{t.existsSync("../src/hooks/slideshow/slideshow-item.hbs")?this.createSlideData("../src/hooks/slideshow/slideshow-item.hbs",e):this.createSlideData("hooks/slideshow/slideshow-item.hbs",e)};createSlideData=(e,s)=>{t.readFile(e,"utf8",(o,i)=>{let a={blocks:[{id:s,type:"code",data:{language:"HTML",text:i}}]};this.socket.emit("slideItem",a)})};createComponentsData=()=>{t.readFile("../../src/data/component.json","utf8",(e,s)=>this.socket.emit("componentsData",JSON.parse(s)))};updateAuthorData=(e,s,o)=>{let i=JSON.parse(e).authors,a=s.authors,n=i.filter(this.utilCompareObj(a)),c=a.filter(this.utilCompareObj(i)),l=n.concat(c),r={post:[]};t.readdir("../../src/data/blog/posts",(g,f)=>{f.forEach(b=>{let S=JSON.parse(t.readFileSync(`../../src/data/blog/posts/${b}`,"utf8"));l.length!==0&&(Object.values(S).find(w=>{(w.id===l[0].id&&w.name!==l[1].name||w.id===l[0].id&&w.avatar!==l[1].avatar)&&(w.name=l[1].name,w.avatar=l[1].avatar)}),t.writeFileSync(`../../src/data/blog/posts/${b}`,JSON.stringify(S,null,2))),r.post.push(S)}),r.post.sort((b,S)=>new Date(`${S.dateCreated} ${S.timeCreated}`)-new Date(`${b.dateCreated} ${b.timeCreated}`)),t.writeFileSync("../../src/data/blog/blog.json",JSON.stringify(r,null,2)),this.postPaginatorPage(r,o)})};saveComponentsData=e=>{t.writeFileSync("../../src/data/component.json",JSON.stringify(e,null,2)),this.saveEmail(e.contactMap.email),this.saveMap(e.contactMap.mapSrc),this.saveSlideshow(e.slideshow),this.saveFooter(),this.saveSocialMedia()};utilCompareObj=e=>function(s){return e.filter(function(o){return o.name==s.name&&o.email==s.email&&o.role==s.role&&o.avatar==s.avatar}).length==0};utilTrimString(e){let s=e.indexOf(" ",150);return s==-1?e:e.substring(0,s)+" ..."}utilCheckHook(){return t.readdirSync("../../src/hooks","utf-8").length!==0}utilEnvPort=()=>{let e=JSON.parse(t.readFileSync("../../src/hooks/settings/env.json","utf-8"));this.socket.emit("envPortData",e)}};var O=class{constructor(e){this.blockit=e}dashboardSocket=e=>{e.on("getDashboardData",()=>this.blockit.createDashboardData())};pagesSocket=e=>{e.on("getPagesData",()=>this.blockit.createPagesData()),e.on("getPagesActionData",()=>this.blockit.createPagesActionData()),e.on("deletePageData",(s,o)=>this.blockit.pagesDeletePage(s,o)),e.on("savePageActionData",(s,o,i)=>this.blockit.pagesSavePage(s,o,i)),e.on("readSectionData",s=>this.blockit.readSectionData(s)),e.on("saveSectionData",(s,o)=>this.blockit.createSectionData(s,o))};navigationSocket=e=>{e.on("getNavigationData",()=>this.blockit.createNavigationData()),e.on("saveNavigation",s=>this.blockit.saveNavigationData(s))};postsSocket=e=>{e.on("getPostsData",()=>this.blockit.createPostsData()),e.on("deletePostData",(s,o)=>this.blockit.postsDeletePost(s,o)),e.on("getPostsActionData",s=>this.blockit.createPostsActionData(s)),e.on("savePostContent",(s,o,i)=>this.blockit.postsSaveContent(s,o,i)),e.on("getEditorData",s=>this.blockit.createEditorData(s)),e.on("triggerTagSources",()=>this.blockit.postsTagSources())};componentsSocket=e=>{e.on("getComponentsData",s=>this.blockit.createComponentsData()),e.on("saveComponents",s=>this.blockit.saveComponentsData(s)),e.on("getSlideItem",s=>this.blockit.createSlideItem(s))};settingsSocket=e=>{e.on("getSettingsData",s=>{this.blockit.createSettingsData()}),e.on("getFooterData",s=>{this.blockit.createFooterData()}),e.on("saveFooterEditor",s=>{this.blockit.saveFooterEditor(s)}),e.on("saveSettingsData",(s,o)=>{this.blockit.saveSettingsData(s,o)}),e.on("assetsUpload",(s,o)=>{this.blockit.assetsUpload(s,o)}),e.on("assetsDelete",s=>{this.blockit.assetsDelete(s)})}};import U from"browser-sync";import Se from"connect-history-api-fallback";var x=class{constructor(e){this.preview=U.create(),this.builder=U.create(),this.compiler=e}run=()=>{this.preview.init({port:3e3,ui:!1,notify:!1,watch:!0,open:!1,server:"../../dist",cors:!0,reloadDebounce:800,callbacks:{ready:(e,s)=>{s.addMiddleware("*",(o,i)=>{i.writeHead(302,{location:"/404.html"}),i.end("Redirecting!")}),this.compiler.blockitWatch()}}}),this.builder.init({port:3001,ui:!1,notify:!1,watch:!0,startPath:"dashboard",server:!0,middleware:[Se()],snippetOptions:{async:!1},logLevel:"silent",callbacks:{ready:(e,s)=>{s.io.sockets.on("connection",o=>{let i=new P(o),a=new O(i);a.dashboardSocket(o),a.pagesSocket(o),a.navigationSocket(o),a.postsSocket(o),a.componentsSocket(o),a.settingsSocket(o)})}}})}};var{src:Y,dest:K,task:v,watch:Q,series:M}=ye,y=new D({src:Y,dest:K,task:v,watch:Q,series:M}),V=new x(y),N=new j({src:Y,dest:K,task:v,watch:Q,series:M});v("build",G(M(N.appInfo,y.buildClean,y.buildHtml,y.buildCss,y.buildJs,y.buildStatic,y.buildImg),h=>N.errHandler(h,y)));v("blockit",G(M(N.appInfo,V.run),h=>N.errHandler(h,V.run)));v("compileCss",y.buildCss);v("minifyCss",y.minifyCss);v("compileJs",y.buildJs);v("minifyJs",y.minifyJs);
