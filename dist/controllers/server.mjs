import n from"./methods.mjs";import s from"./sockets.mjs";import a from"browser-sync";import c from"connect-history-api-fallback";export default class l{constructor(r){this.frontEnd=a.create(),this.backEnd=a.create(),this.compiler=r}serverInit=()=>{this.frontEnd.init({port:3e3,ui:!1,notify:!1,watch:!0,open:!1,server:"../../dist",cors:!0,reloadDebounce:800,callbacks:{ready:(r,i)=>{i.addMiddleware("*",(e,o)=>{o.writeHead(302,{location:"/404.html"}),o.end("Redirecting!")}),this.compiler.blockitWatch()}}}),this.backEnd.init({port:3001,ui:!1,notify:!1,watch:!0,startPath:"dashboard",server:"views",middleware:[c()],snippetOptions:{async:!1},logPrefix:"Blockit",logLevel:"silent",callbacks:{ready:(r,i)=>{i.io.sockets.on("connection",e=>{const o=new n(e),t=new s(o);t.dashboardSocket(e),t.pagesSocket(e),t.navigationSocket(e),t.postsSocket(e),t.componentsSocket(e),t.settingsSocket(e)})}}})}}
